# v5.0.0 (Major Release)

<!-- alex-c-line-start-release-status -->
**Status**: Released
<!-- alex-c-line-end-release-status -->

<!-- alex-c-line-start-release-summary -->
This is a new major release of the `@alextheman/utility` package. It has the potential to introduce breaking changes that may require a large amount of refactoring. Please read the description of changes and migration notes below for more information.
<!-- alex-c-line-end-release-summary -->

## Description of Changes

- Add the following new entrypoints:
    - `@alextheman/utility`: Still here, still the main entrypoint.
    - `@alextheman/utility/node`: For node-specific utilities that are more tailored towards Node workflows.
        - Also note that `normaliseImportPath`/`normalizeImportPath` has also been moved to this entrypoint and is no longer discoverable at root.
    - `@alextheman/utility/internal`: For utilities that are more tailored to my repositories and are not necessarily designed with public usage in mind. May change in breaking ways across minor/patch releases.
- Removes the following deprecations:
    - All versioning utilities that were deprecated in [v4.2.0](https://github.com/alextheman231/utility/blob/main/docs/releases/v4/v4.2/v4.2.0.md) have been removed in favour of the `VersionNumber` class
    - `getInterpolations` has been removed in favour of `getStringsAndInterpolations`
    - `getPublicAndPrivateKey` has been removed in favour of `sodium.crypto_box_keypair()` from `libsodium-wrappers`
- The `data` argument of `DataError` must now be a `Record<RecordKey, unknown>` rather than just `unknown`.
    - `RecordKey` as of now more specifically is `string | number | symbol`.
    - This change encourages users to take more consideration as to what the data they are passing in here really represents, as it now must have a descriptive key name.
- Adds a `.format()` method to instances of `VersionNumber`
    - This also replaces `new VersionNumber(version).toString({ omitPrefix })`. You should now do `new VersionNumber(version).format({ omitPrefix })`.
    - On top of that, you now have the option to `omitMinor` or `omitPatch`. If `omitMinor` is true, both the minor and patch versions will be omitted. If `omitPatch` is true, only the patch version will be omitted.
    - `omitPatch` cannot exist at the same time as `omitMinor: true`, as enforced by discriminated union.

## Migration Notes

### Versioning functions

See the [v4.2.0 migration notes](https://github.com/alextheman231/utility/blob/main/docs/releases/v4/v4.2/v4.2.0.md#migration-notes) for more information.

### getInterpolations

Replace with `getStringsAndInterpolations`

Before:
```typescript
import { createTemplateStringsArray, getInterpolations, interpolate } from "@alextheman/utility";

function getPackageInfo(packageName: string, packageManager: string): string {
    const [strings, interpolations] = getInterpolations`The package ${packageName} uses the ${packageManager} package manager.`;
    return interpolate(createTemplateStringsArray(strings), ...interpolations);
}
```

After:
```typescript
import { getStringsAndInterpolations, interpolate } from "@alextheman/utility";

function getPackageInfo(packageName: string, packageManager: string): string {
    return interpolate(...getStringsAndInterpolations`The package ${packageName} uses the ${packageManager} package manager.`);
}
```

### DataError

Convert all `DataError` data inputs to be objects if it's not already that. Decide on a clear, descriptive key name for all data inputs to `DataError`.
- **Tip:** Most of the time, you can just surround what you already have in curly brackets. Example:

Before:
```typescript
const input: string = "Invalid";

throw new DataError(input);
```

After:
```typescript
const input: string = "Invalid";

throw new DataError({ input });
```

### VersionNumber

Migrate from using `new VersionNumber(version).toString({ omitPrefix: true })` to `new VersionNumber(version).format({ omitPrefix: true })`.

You may also try exploring the new `omitMinor` and `omitPatch` properties in the following way:

```typescript
new VersionNumber("1.2.3").format({ omitMinor: true }) // "v1"
new VersionNumber("1.2.3").format({ omitPatch: true }) // "v1.2"
```

### getPublicAndPrivateKey

Replace with `sodium.crypto_box_keypair` from `libsodium-wrappers`

Before:
```typescript
const { publicKey, privateKey } = getPublicAndPrivateKey("uint8array");
```

After:
```typescript
import sodium from "libsodium-wrappers";
const { publicKey, privateKey } = sodium.crypto_box_keypair("uint8array");
```

## Additional Notes

- Wow, that's a lot of cleanup!
- Quite a lot of good changes here, I think - from the entrypoints refactor to the removal of long-standing deprecations, utility is in a nice place now.
- Of course, I am testing the new entrypoints! Poor NPM is suffering with its end-to-end runs, taking longer than even the PNPM TypeScript ones, but hey! It is trying.
- Either way, I think it's worth it. It gives us extra confidence that the package will resolve correctly in many different scenarios.
- Next major release should hopefully be `alex-c-line` v2 now! That's coming along nicely, although there's still quite a bit of work to be done. Still, I'm hopeful we can get it out before April, I think.
- In any case, keep an eye out on the release notes for more information!

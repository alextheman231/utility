# v5.2.0 (Minor Release)

<!-- alex-c-line-start-release-status -->
**Status**: In progress
<!-- alex-c-line-end-release-status -->

<!-- alex-c-line-start-release-summary -->
This is a new minor release of the `@alextheman/utility` package. It introduces new features in a backwards-compatible way and should require very little refactoring, if any. Please read the description of changes below.
<!-- alex-c-line-end-release-summary -->

## Description of Changes

- Adds a static `expectError` method to `DataError`
    - It takes a function, runs it, and returns the `DataError` thrown if it threw a `DataError` specifically, otherwise it throws a regular error if it didn't throw, or it threw an error that is not a `DataError`.
    - This is especially useful in tests, turning verbose checks like this:

    ```typescript
    test("The error function can return nothing", () => {
        let wasCalled = false;
        try {
            expect(wasCalled).toBe(false);
            parseZodSchema(z.string(), 1, () => {
                wasCalled = true;
            });
            throw new Error("DID_NOT_THROW");
        } catch (error) {
            expect(wasCalled).toBe(true);
            if (DataError.check(error)) {
                expect(error.data.input).toBe(1);
                expect(error.code).toBe("INVALID_TYPE");
            } else {
                throw error
            }
        }
    });
    ```

    into this:

    ```typescript
    test("The error function can return nothing", () => {
        let wasCalled = false;
        const error = DataError.expectError(() => {
            parseZodSchema(z.string(), 1, () => {
                wasCalled = true;
            });
        });

        expect(wasCalled).toBe(true);
        expect(error.data.input).toBe(1);
        expect(error.code).toBe("INVALID_TYPE");
    });
    ```

## Additional Notes

- All previous cases where we had that verbose try/catch, and then checking for the `DataError` in the catch before asserting, has been replaced all throughout this repository with the `expectError` pattern.
- I have also gone through and converted all remaining manually thrown errors to be `DataError`s rather than, say, a regular `Error` or `TypeError` (TODO for now).
- This will make the error handling throughout the package feel more consistent and far more maintainable overall.
